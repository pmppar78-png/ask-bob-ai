<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Chat – Ask Bob AI Home & Auto Project Assistant</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Chat with Bob, your AI-powered home improvement and auto repair assistant. Get step-by-step project plans, tool recommendations, and safety guidance for DIY projects." />
  <link rel="canonical" href="https://askbobai.org/chat.html" />
  <style>
    :root {
      --bg: #020617;
      --panel: #020617;
      --card: #020617;
      --msg-user: #0f172a;
      --msg-ai: #020617;
      --accent: #ffb347;
      --accent-strong: #ff8c00;
      --border-subtle: rgba(148,163,184,0.4);
      --text: #f9fafb;
      --muted: #cbd5f5;
      --link: #38bdf8;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #020617 0, #020617 40%, #000 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    a { color: var(--link); }

    header {
      position: sticky;
      top: 0;
      z-index: 30;
      background: linear-gradient(90deg, rgba(15,23,42,0.96), rgba(15,23,42,0.9));
      border-bottom: 1px solid rgba(148,163,184,0.35);
      backdrop-filter: blur(18px);
    }

    .nav-inner {
      max-width: 1120px;
      margin: 0 auto;
      padding: 14px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 25%, #ffe29f, #ffa99f 40%, #ff6a00 75%);
      box-shadow: 0 0 18px rgba(248, 250, 252, 0.2);
    }

    .brand-text-title {
      font-weight: 700;
      letter-spacing: 0.03em;
      font-size: 1.2rem;
    }

    .brand-text-sub {
      font-size: 0.76rem;
      color: var(--muted);
      opacity: 0.9;
    }

    nav a {
      color: var(--muted);
      margin-left: 16px;
      font-size: 0.95rem;
      text-decoration: none;
    }

    nav a:hover { color: var(--text); }

    nav a.active {
      color: var(--text);
      font-weight: 600;
    }

    .nav-pill {
      padding: 8px 18px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, var(--accent-strong), #facc15);
      color: #111827;
      font-weight: 650;
      font-size: 0.95rem;
      box-shadow: 0 10px 24px rgba(250, 204, 21, 0.25);
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 0;
      overflow: hidden;
    }

    .chat-shell {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .chat-panel {
      background: rgba(15,23,42,0.98);
      display: flex;
      flex-direction: column;
      flex: 1;
      min-height: 0;
    }

    .chat-header {
      padding: 12px 16px;
      border-bottom: 1px solid rgba(30,64,175,0.5);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .chat-header-content {
      flex: 1;
      min-width: 200px;
    }

    .chat-header-title {
      font-weight: 600;
      font-size: 1rem;
    }

    .chat-header-sub {
      font-size: 0.82rem;
      color: var(--muted);
      margin-top: 2px;
    }

    .help-toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      background: rgba(15,23,42,0.9);
      color: var(--muted);
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .help-toggle:hover {
      background: rgba(30,64,175,0.3);
      color: var(--text);
    }

    .help-toggle.active {
      background: rgba(30,64,175,0.4);
      color: var(--text);
      border-color: var(--accent);
    }

    .help-toggle svg {
      width: 16px;
      height: 16px;
    }

    .messages {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      min-height: 0;
    }

    .msg {
      border-radius: 14px;
      padding: 12px 14px;
      font-size: 0.95rem;
      line-height: 1.55;
      max-width: 85%;
    }

    .msg.user {
      background: #020617;
      border: 1px solid rgba(148,163,184,0.6);
      align-self: flex-end;
    }

    .msg.ai {
      background: radial-gradient(circle at top left, rgba(248,250,252,0.06), rgba(15,23,42,0.98));
      border: 1px solid rgba(148,163,184,0.55);
      align-self: flex-start;
    }

    .msg.system {
      background: rgba(15,23,42,0.9);
      border: 1px dashed rgba(148,163,184,0.6);
      font-size: 0.9rem;
    }

    .msg-error {
      background: rgba(127,29,29,0.3);
      border: 1px solid rgba(248,113,113,0.6);
      color: #fecaca;
    }

    .badge-inline {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.78rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(148,163,184,0.6);
      color: #e5e7eb;
    }

    .affiliate-list {
      margin-top: 6px;
      padding-left: 20px;
    }

    form {
      padding: 12px 16px 16px;
      border-top: 1px solid rgba(30,64,175,0.5);
      display: flex;
      gap: 10px;
      align-items: flex-end;
      background: rgba(15,23,42,0.98);
    }

    textarea {
      flex: 1;
      resize: none;
      min-height: 48px;
      max-height: 150px;
      border-radius: 12px;
      border: 1px solid rgba(148,163,184,0.6);
      background: #020617;
      color: var(--text);
      padding: 12px;
      font-size: 0.95rem;
      font-family: inherit;
    }

    textarea::placeholder {
      color: rgba(148,163,184,0.9);
    }

    textarea:focus {
      outline: none;
      border-color: var(--accent);
    }

    button.send {
      border-radius: 999px;
      padding: 12px 20px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.95rem;
      background: linear-gradient(135deg, var(--accent-strong), #f97316);
      color: #111827;
      min-width: 90px;
      box-shadow: 0 10px 26px rgba(249,115,22,0.35);
    }

    button.send:disabled {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
    }

    /* Help Panel - Collapsible Drawer */
    .help-panel {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      width: 380px;
      max-width: 90vw;
      background: rgba(15,23,42,0.98);
      border-left: 1px solid rgba(30,64,175,0.7);
      box-shadow: -8px 0 32px rgba(0,0,0,0.4);
      transform: translateX(100%);
      transition: transform 0.3s ease;
      z-index: 20;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    .help-panel.open {
      transform: translateX(0);
    }

    .help-panel-header {
      padding: 14px 16px;
      border-bottom: 1px solid rgba(30,64,175,0.5);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      background: rgba(15,23,42,0.98);
      z-index: 1;
    }

    .help-panel-header h2 {
      margin: 0;
      font-size: 1.05rem;
      color: var(--text);
    }

    .help-close {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 8px;
      border: none;
      background: transparent;
      color: var(--muted);
      cursor: pointer;
      font-size: 1.2rem;
    }

    .help-close:hover {
      background: rgba(30,64,175,0.3);
      color: var(--text);
    }

    .help-content {
      padding: 16px;
      font-size: 0.88rem;
      color: var(--muted);
      flex: 1;
    }

    .help-content h3 {
      margin: 20px 0 8px;
      font-size: 0.95rem;
      color: var(--text);
    }

    .help-content h3:first-child {
      margin-top: 0;
    }

    .help-content p {
      margin: 0 0 10px;
      line-height: 1.5;
    }

    .help-content ul {
      padding-left: 18px;
      margin: 8px 0;
    }

    .help-content li {
      margin-bottom: 6px;
      line-height: 1.45;
    }

    /* Overlay for mobile */
    .help-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      z-index: 15;
    }

    .help-overlay.visible {
      opacity: 1;
      visibility: visible;
    }

    .sponsor-notice {
      padding: 10px 16px;
      font-size: 0.82rem;
      color: var(--muted);
      border-bottom: 1px solid rgba(30,64,175,0.3);
      background: rgba(15,23,42,0.5);
    }

    footer {
      padding: 10px 16px 14px;
      font-size: 0.78rem;
      color: #9ca3af;
      border-top: 1px solid rgba(30,64,175,0.7);
      background: #020617;
    }

    .footer-inner {
      max-width: 1120px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    @media (max-width: 880px) {
      .help-toggle span {
        display: none;
      }
      .help-panel {
        width: 100%;
        max-width: 100%;
      }
      .chat-header {
        padding: 10px 12px;
      }
      .chat-header-title {
        font-size: 0.9rem;
      }
      .chat-header-sub {
        font-size: 0.78rem;
      }
      .messages {
        padding: 12px;
      }
      .msg {
        max-width: 92%;
        padding: 10px 12px;
        font-size: 0.9rem;
      }
      form {
        padding: 10px 12px 14px;
      }
      textarea {
        min-height: 44px;
        padding: 10px;
        font-size: 0.9rem;
      }
      button.send {
        padding: 10px 16px;
        min-width: 70px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="nav-inner">
      <div class="brand">
        <div class="brand-logo"></div>
        <div>
          <div class="brand-text-title">Ask Bob AI</div>
          <div class="brand-text-sub">Project &amp; repair guidance</div>
        </div>
      </div>
      <nav>
        <a href="index.html">Home</a>
        <a href="chat.html" class="active">AI Chat</a>
        <a href="about.html">About</a>
        <a href="index.html#home-diy">Home DIY</a>
        <a href="index.html#auto-projects">Auto</a>
        <a href="index.html#advertise">Partners</a>
      </nav>
    </div>
  </header>

  <main>
    <div class="chat-shell">
      <div class="sponsor-notice">
        Some suggestions may include sponsored partners. This does not affect guidance.
      </div>
      <section class="chat-panel" aria-label="Ask Bob AI conversation">
        <div class="chat-header">
          <div class="chat-header-content">
            <div class="chat-header-title">Ask Bob anything about tools, materials, wiring plans, or car work.</div>
            <div class="chat-header-sub">
              Bob outlines safe, realistic steps — with optional partner recommendations clearly labeled.
            </div>
          </div>
          <button type="button" class="help-toggle" id="help-toggle" aria-label="Toggle help panel">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            <span>Tips</span>
          </button>
        </div>
        <div id="messages" class="messages">
          <div class="msg system">
            <strong>Bob AI:</strong> Welcome! I'm here to help you plan safe, realistic home and auto projects. Tell me what you're working on and I'll help you break it down into clear, manageable steps. For best results, include your location, tools available, and experience level.
          </div>
        </div>
        <form id="chat-form">
          <textarea id="user-input" placeholder="Example: Plan a safe deck build, or change front brakes on my SUV..." required></textarea>
          <button type="submit" class="send" id="send-btn">Send</button>
        </form>
      </section>

      <!-- Help Panel Overlay -->
      <div class="help-overlay" id="help-overlay"></div>

      <!-- Collapsible Help Panel -->
      <aside class="help-panel" id="help-panel" aria-label="Help and tips">
        <div class="help-panel-header">
          <h2>How to get the best answers</h2>
          <button type="button" class="help-close" id="help-close" aria-label="Close help panel">&times;</button>
        </div>
        <div class="help-content">
          <h3>Include in your questions:</h3>
          <ul>
            <li><strong>Location context:</strong> Where the work is happening (house, garage, driveway, basement, etc.) affects material choices and code requirements.</li>
            <li><strong>Current conditions:</strong> What you're starting with (existing deck, bare concrete, noisy brakes, warning lights) helps Bob understand your situation.</li>
            <li><strong>Your resources:</strong> Tools you already own, your experience level, and any budget constraints help Bob tailor realistic recommendations.</li>
            <li><strong>Specific goals:</strong> What outcome you're trying to achieve and any deadlines or constraints you're working with.</li>
          </ul>

          <h3>Example questions for home projects</h3>
          <ul>
            <li>"Plan a safe 12×16 deck build with stairs. I have basic carpentry experience and own a circular saw, drill, and level."</li>
            <li>"What tools do I actually need to wire a small workshop? I'm comfortable with basic electrical but never wired a whole room."</li>
            <li>"Help me understand the proper way to frame an interior wall. My house was built in 1975 and I'm not sure about existing framing spacing."</li>
            <li>"I need to repair rotted fascia board on my garage. How do I assess how much needs to be replaced?"</li>
          </ul>

          <h3>Example questions for auto projects</h3>
          <ul>
            <li>"Help me replace front brake pads and rotors on a 2016 Civic. This is my first brake job — what tools do I need?"</li>
            <li>"My 2019 F-150 makes a clunking noise when going over bumps. What should I inspect first?"</li>
            <li>"I want to change the oil on my 2020 RAV4. What weight oil does it need and how much?"</li>
            <li>"Walk me through replacing spark plugs on a 2014 Camry. Is this a good DIY project?"</li>
          </ul>

          <h3>Understanding Bob's guidance</h3>
          <p>
            Bob provides educational information to help you plan projects and understand what's involved.
            His guidance reflects general best practices, but your specific situation may require
            adjustments. Always verify measurements, check local codes, and consult professionals for
            safety-critical work.
          </p>

          <h3>Safety first</h3>
          <p>
            Ask Bob AI is for educational planning purposes only. Always follow local building codes,
            manufacturer instructions, and work with licensed professionals for structural, electrical,
            gas, and other safety-critical work. When working on vehicles, always use proper jack stands,
            wear appropriate safety equipment, and follow torque specifications.
          </p>
        </div>
      </aside>
    </div>
  </main>

  <footer>
    <div class="footer-inner">
      <span>&copy; 2025 Ask Bob AI. Planning help only &mdash; not a licensed contractor or mechanic. Some suggestions may include sponsored partners. This does not affect guidance.</span>
      <span><a href="about.html">About</a> · <a href="privacy.html">Privacy</a> · <a href="terms.html">Terms</a> · <a href="disclaimer.html">Disclaimer</a> · <a href="contact.html">Contact</a></span>
    </div>
  </footer>

  <script>
    const form = document.getElementById('chat-form');
    const userInput = document.getElementById('user-input');
    const messagesEl = document.getElementById('messages');
    const sendBtn = document.getElementById('send-btn');

    // Help panel toggle functionality
    const helpToggle = document.getElementById('help-toggle');
    const helpPanel = document.getElementById('help-panel');
    const helpClose = document.getElementById('help-close');
    const helpOverlay = document.getElementById('help-overlay');

    function openHelpPanel() {
      helpPanel.classList.add('open');
      helpOverlay.classList.add('visible');
      helpToggle.classList.add('active');
    }

    function closeHelpPanel() {
      helpPanel.classList.remove('open');
      helpOverlay.classList.remove('visible');
      helpToggle.classList.remove('active');
    }

    helpToggle.addEventListener('click', () => {
      if (helpPanel.classList.contains('open')) {
        closeHelpPanel();
      } else {
        openHelpPanel();
      }
    });

    helpClose.addEventListener('click', closeHelpPanel);
    helpOverlay.addEventListener('click', closeHelpPanel);

    // Close help panel on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && helpPanel.classList.contains('open')) {
        closeHelpPanel();
      }
    });

    function appendMessage(text, role, isError) {
      const div = document.createElement('div');
      div.classList.add('msg');
      if (role === 'user') div.classList.add('user');
      else if (role === 'assistant') div.classList.add('ai');
      else div.classList.add('system');
      if (isError) div.classList.add('msg-error');

      // Simple markdown-style link rendering [text](url)
      const html = text.replace(/\[([^\]]+)\]\((https?:[^)]+)\)/g, '<a href="$2" target="_blank" rel="sponsored noopener">$1</a>');
      div.innerHTML = html;
      messagesEl.appendChild(div);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const content = userInput.value.trim();
      if (!content) return;

      appendMessage(content, 'user');
      userInput.value = '';
      userInput.focus();
      sendBtn.disabled = true;
      sendBtn.textContent = 'Thinking…';

      try {
        const res = await fetch('/.netlify/functions/ai-chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: content })
        });

        if (!res.ok) {
          throw new Error('Request failed with status ' + res.status);
        }

        const data = await res.json();
        const reply = data.reply || 'Sorry, I had trouble understanding that.';
        appendMessage(reply, 'assistant');
      } catch (err) {
        console.error(err);
        appendMessage('Sorry — I had trouble reaching the AI engine. Please try again in a moment.', 'assistant', true);
      } finally {
        sendBtn.disabled = false;
        sendBtn.textContent = 'Send';
      }
    });

    // Auto-resize textarea as user types
    userInput.addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = Math.min(this.scrollHeight, 150) + 'px';
    });
  </script>
</body>
</html>
